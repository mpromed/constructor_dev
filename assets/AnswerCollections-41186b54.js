import{r as f,a as i,o as g,c as q,b as e,w as t,d as b,k as _,H as G,m as J,z as K,A as O,B as P,l as Q,g as X,f as D,x as V}from"./index-93aba21e.js";import Y from"./WarningParameters-5894d6e4.js";import"./ColorItem-4730e3b6.js";const Z={class:"collection-answer-wrapper"},ee={key:0},le={class:"dialog-footer"},ae={__name:"AnswerCollections",props:["answerCollectionsData","answersList"],emits:["addCollectionToList","deleteCollection","updateCollectionItem"],setup(h,{emit:k}){const u=h,R=f(),s=f(null),r=f(!1),n=f(),v=f(!1),c=f([]),U=()=>{const o=[];for(let l=0;l<c.value.length;l++)c.value[l]&&o.push(u.answersList[l].id);n.value.selectedIdList=o,console.log(n.value),k("addCollectionToList",n.value),r.value=!1},y=()=>{if(u.answerCollectionsData.length===0)return 0;const o=u.answerCollectionsData.map(m=>m.id);return Math.max(...o)},L=()=>{if(u.answerCollectionsData.length===0)return 0;const o=u.answerCollectionsData.map(m=>m.seqNo);return Math.max(...o)},T=()=>{c.value=u.answersList.map(o=>!1),n.value={id:y()+1,name:"",description:"",seqNo:L()+1,checkedList:[],isRight:!1,useCollectionWarning:!1,collectionWarning:{text:"Все верно",color:"#A3D65C",image:{label:"",imageURL:""},showTime:0,buttons:[{buttonName:"Закрыть",action:{name:"closeModalWarning"}}]}},v.value=!1,r.value=!0},A=()=>{s.value&&(console.log(s.value),c.value=u.answersList.map(o=>!!s.value.selectedIdList.find(l=>l===o.id)),console.log(c.value),n.value={id:y()+1,name:s.value.name+"copy",description:s.value.description,seqNo:L()+1,checkedList:s.value.checkedList,isRight:s.value.isRight,useCollectionWarning:s.value.useCollectionWarning,collectionWarning:s.value.collectionWarning},v.value=!1,r.value=!0)},B=(o,l)=>{c.value=u.answersList.map(m=>!!o.selectedIdList.find(C=>C===m.id)),n.value=o,v.value=!0,r.value=!0},M=()=>{const o=[];for(let l=0;l<c.value.length;l++)c.value[l]&&o.push(u.answersList[l].id);n.value.selectedIdList=o,k("updateCollectionItem",n.value),r.value=!1},$=()=>{s.value&&k("deleteCollection",s.value.id)},E=o=>{s.value=o};return(o,l)=>{const m=i("el-col"),C=i("el-row"),d=i("el-button"),z=i("el-popconfirm"),p=i("el-table-column"),F=i("el-icon"),x=i("el-table"),N=i("el-input"),w=i("el-form-item"),S=i("el-checkbox"),I=i("el-switch"),H=i("el-form"),j=i("el-dialog");return g(),q("div",Z,[e(C,null,{default:t(()=>[e(m,null,{default:t(()=>[b("Коллекции ответов пользователя")]),_:1})]),_:1}),e(C,null,{default:t(()=>[e(m,null,{default:t(()=>[e(d,{type:"success",icon:_(G),onClick:T},null,8,["icon"]),e(d,{type:"success",icon:_(J),onClick:A},null,8,["icon"]),e(d,{type:"warning",icon:_(K),onClick:o.moveModuleTestUp},null,8,["icon","onClick"]),e(d,{type:"warning",icon:_(O),onClick:o.moveModuleTestDown},null,8,["icon","onClick"]),e(z,{"confirm-button-text":"Да","cancel-button-text":"Нет","icon-color":"#F56C6C",title:"Вы уверены, что хотите удалить коллекцию?",onConfirm:$,width:"350"},{reference:t(()=>[e(d,{type:"danger",icon:_(P)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e(x,{ref_key:"tableAnswerCollectionsRef",ref:R,data:h.answerCollectionsData,onCurrentChange:E,style:{width:"100%"},border:"","highlight-current-row":""},{default:t(()=>[e(p,{prop:"id",label:"id",width:"60"}),e(p,{prop:"seqNo",label:"seqNo",width:"100"}),e(p,{prop:"name",label:"Наименование",width:"180"}),e(p,{prop:"collection",label:"Коллекция",width:"180"}),e(p,{label:"Управление"},{default:t(a=>[e(d,{class:"control_btn",size:"small",onClick:W=>B(a.row)},{default:t(()=>[e(F,{size:"small",color:"#FF8A00"},{default:t(()=>[e(_(Q))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(j,{modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=a=>r.value=a),title:"Набор ответов",width:"700"},{footer:t(()=>[X("div",le,[e(d,{onClick:l[4]||(l[4]=a=>r.value=!1)},{default:t(()=>[b("Отмена")]),_:1}),v.value?V("",!0):(g(),D(d,{key:0,type:"primary",onClick:U},{default:t(()=>[b("Создать")]),_:1})),v.value?(g(),D(d,{key:1,type:"primary",onClick:M},{default:t(()=>[b("Сохранить")]),_:1})):V("",!0)])]),default:t(()=>[e(H,{model:n.value},{default:t(()=>[e(w,{label:"Наименование"},{default:t(()=>[e(N,{modelValue:n.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>n.value.name=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Описание"},{default:t(()=>[e(N,{modelValue:n.value.description,"onUpdate:modelValue":l[1]||(l[1]=a=>n.value.description=a)},null,8,["modelValue"])]),_:1}),e(x,{ref:"multipleTableRef",data:h.answersList,style:{width:"100%"},border:""},{default:t(()=>[e(p,{property:"answerText",label:"Ответ",width:"200"}),e(p,{label:"Выбран",width:"100"},{default:t(a=>[e(S,{modelValue:c.value[a.$index],"onUpdate:modelValue":W=>c.value[a.$index]=W},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{label:"Необязательный",width:"100"})]),_:1},8,["data"]),e(w,{label:"Верный ответ"},{default:t(()=>[e(I,{modelValue:n.value.isRight,"onUpdate:modelValue":l[2]||(l[2]=a=>n.value.isRight=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Предупреждение"},{default:t(()=>[e(I,{modelValue:n.value.useCollectionWarning,"onUpdate:modelValue":l[3]||(l[3]=a=>n.value.useCollectionWarning=a)},null,8,["modelValue"])]),_:1}),n.value.useCollectionWarning?(g(),q("div",ee,[e(Y,{parameters:n.value.collectionWarning},null,8,["parameters"])])):V("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{ae as default};
