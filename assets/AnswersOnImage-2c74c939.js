import{_ as Y,r as y,q as j,G as z,a as d,o as i,c as u,b as a,w as _,f as V,v as f,g as l,F as S,e as R,H as $,I as G,x as A,d as M,J,K}from"./index-390646fc.js";import Q from"./ContentImages-0b0bf88b.js";import W from"./ColorItem-baefa09f.js";import Z from"./ActionItem-95985def.js";import ee from"./AnswerCollections-63af905b.js";import"./WarningParameters-478bbabb.js";const b=c=>(J("data-v-9f3ce3ef"),c=c(),K(),c),te={key:0},ne=["src"],oe=["onMousedown"],se={class:"marker-index"},ae={key:1,class:"markers-table"},le={key:2,class:"marker-info"},ie={class:"slider-text"},ce={class:"checkboxes"},me=b(()=>l("div",{class:"checkbox-text"},"Правильный ?",-1)),re={class:"checkboxes"},de=b(()=>l("div",{class:"checkbox-text"},"Не обязательный ?",-1)),ue=b(()=>l("div",{class:"slider-text"},"Размер маркера ",-1)),pe=b(()=>l("div",{class:"slider-text"},"Размер хитбокса ",-1)),we={class:"action_edit"},O=2,ge=50,T=2,he=50,ve={__name:"AnswersOnImage",props:["componentData"],setup(c){const e=c;console.log(e.componentData);const s=y(null),U=y(null),w=y(null),m=y({width:0,height:0});e.componentData.answersButtonType="buttonsOnImage";const C=(n,t)=>n/t*100,D=(n,t)=>n/100*t,B=n=>({position:"absolute",top:`${n.y}%`,left:`${n.x}%`,transform:"translate(-50%, -50%)",width:`${D(n.size,m.value.width)}px`,height:`${D(n.size,m.value.width)}px`,background:`${n.color}`}),E=n=>({position:"absolute",top:`${n.y}%`,left:`${n.x}%`,transform:"translate(-50%, -50%)",width:`${D(n.hitboxSize,m.value.width)}px`,height:`${D(n.hitboxSize,m.value.width)}px`,backgroundColor:`${n.color}55`,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",boxSizing:"border-box",cursor:"pointer"}),q=()=>{s.value!==null&&(e.componentData.answersList.splice(s.value,1),s.value=e.componentData.answersList.length-1)},H=n=>{if(n.target.classList.contains("content-image")){const t=w.value.getBoundingClientRect(),p=(n.clientX-t.left)/t.width*100,r=(n.clientY-t.top)/t.height*100;e.componentData.answersList.push({index:e.componentData.answersList.length+1,isRight:!1,notRequired:!1,answerText:"",action:{doAction:!1,clickAction:!1,name:"moveToStep",internalId:0,checkQuestion:!1,trackRepeatAnswer:!1},style:{x:p,y:r,size:C(O,t.width),hitboxSize:C(T,t.width)}}),s.value=e.componentData.answersList.length-1,console.log(e.componentData.answersList)}},N=(n,t)=>{n.preventDefault(),s.value=t;const p=g=>{const h=w.value.getBoundingClientRect();let x=(g.clientX-h.left)/h.width*100,v=(g.clientY-h.top)/h.height*100;x=Math.max(0,Math.min(x,100)),v=Math.max(0,Math.min(v,100)),e.componentData.answersList[s.value].style.x=x,e.componentData.answersList[s.value].style.y=v},r=()=>{document.removeEventListener("mousemove",p),document.removeEventListener("mouseup",r)};document.addEventListener("mousemove",p),document.addEventListener("mouseup",r)},k=()=>{z(()=>{if(w.value&&w.value.complete){const{width:n,height:t}=w.value.getBoundingClientRect();m.value.width=n,m.value.height=t,console.log(m.value.width),console.log(m.value.height)}else console.log("Изображение еще не загружено или элемент не найден")})};j(async()=>{await z(),k()});const F=n=>{let t=n.index-1;s.value=t};return(n,t)=>{const p=d("el-switch"),r=d("el-form-item"),g=d("el-table-column"),h=d("el-table"),x=d("el-input"),v=d("el-checkbox"),I=d("el-slider"),P=d("el-button");return i(),u(S,null,[a(r,{label:"Ответы на картинке?"},{default:_(()=>[a(p,{modelValue:e.componentData.isAnswersOnImage,"onUpdate:modelValue":t[0]||(t[0]=o=>e.componentData.isAnswersOnImage=o),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])]),_:1}),e.componentData.isAnswersOnImage?(i(),u("div",te,[a(r,{label:"Множественный выбор:"},{default:_(()=>[a(p,{modelValue:e.componentData.multiple,"onUpdate:modelValue":t[1]||(t[1]=o=>e.componentData.multiple=o)},null,8,["modelValue"])]),_:1}),e.componentData.isAnswersOnImage?(i(),V(r,{key:0,label:"Картинка:"},{default:_(()=>[e.componentData.imagesData&&e.componentData.isAnswersOnImage?(i(),V(Q,{key:0,componentData:e.componentData.imagesData,isSingleImage:e.componentData.isAnswersOnImage},null,8,["componentData","isSingleImage"])):f("",!0),l("div",{class:"image-container",onClick:t[2]||(t[2]=o=>H(o)),ref_key:"imageContainer",ref:U,onLoad:k},[l("img",{class:"content-image",src:e.componentData.imagesData.imagesList[0].imageURL,ref_key:"imageElement",ref:w,onLoad:k},null,40,ne),(i(!0),u(S,null,R(e.componentData.answersList,(o,L)=>(i(),u("div",{class:"marker",key:L,style:$(B(o.style)),onMousedown:G(X=>N(X,L),["prevent"])},[l("div",se,A(o.index),1)],44,oe))),128)),(i(!0),u(S,null,R(e.componentData.answersList,(o,L)=>(i(),u("div",{class:"hitbox",key:L,style:$(E(o.style))},null,4))),128))],544),e.componentData.answersList.length>0?(i(),u("div",ae,[a(h,{data:e.componentData.answersList,style:{width:"100%"},border:"","highlight-current-row":"",onRowClick:F},{default:_(()=>[a(g,{prop:"index",label:"id",width:"40"}),a(g,{prop:"answerText",label:"Текст ответа",width:"115"}),a(g,{prop:"isRight",label:"Значение",width:"115"},{default:_(({row:o})=>[l("span",null,A(o.isRight?"Правильный":"Неправильный"),1)]),_:1})]),_:1},8,["data"])])):f("",!0),s.value!==null&&e.componentData.answersList.length>0?(i(),u("div",le,[l("div",ie,[M("Текст ответа"),a(x,{modelValue:e.componentData.answersList[s.value].answerText,"onUpdate:modelValue":t[3]||(t[3]=o=>e.componentData.answersList[s.value].answerText=o)},null,8,["modelValue"])]),l("div",ce,[me,a(v,{modelValue:e.componentData.answersList[s.value].isRight,"onUpdate:modelValue":t[4]||(t[4]=o=>e.componentData.answersList[s.value].isRight=o),size:"large"},null,8,["modelValue"])]),l("div",re,[de,a(v,{modelValue:e.componentData.answersList[s.value].notRequired,"onUpdate:modelValue":t[5]||(t[5]=o=>e.componentData.answersList[s.value].notRequired=o),size:"large"},null,8,["modelValue"])]),ue,a(I,{modelValue:e.componentData.answersList[s.value].style.size,"onUpdate:modelValue":t[6]||(t[6]=o=>e.componentData.answersList[s.value].style.size=o),min:O,max:ge,step:.1},null,8,["modelValue"]),pe,a(I,{modelValue:e.componentData.answersList[s.value].style.hitboxSize,"onUpdate:modelValue":t[7]||(t[7]=o=>e.componentData.answersList[s.value].style.hitboxSize=o),min:T,max:he,step:.1},null,8,["modelValue"]),a(P,{onClick:q},{default:_(()=>[M("Удалить маркер")]),_:1}),a(W,{modelValue:e.componentData.answersList[s.value].style.color,"onUpdate:modelValue":t[8]||(t[8]=o=>e.componentData.answersList[s.value].style.color=o)},null,8,["modelValue"]),l("div",we,[a(Z,{action:e.componentData.answersList[s.value].action},null,8,["action"])])])):f("",!0),c.componentData.answersList?(i(),V(ee,{key:3,answerCollectionsData:c.componentData.answerCollections,answersList:c.componentData.answersList,onAddCollectionToList:t[9]||(t[9]=o=>n.addCollectionToList(o)),onDeleteCollection:t[10]||(t[10]=o=>n.deleteCollection(o))},null,8,["answerCollectionsData","answersList"])):f("",!0)]),_:1})):f("",!0)])):f("",!0)],64)}}},be=Y(ve,[["__scopeId","data-v-9f3ce3ef"]]);export{be as default};
