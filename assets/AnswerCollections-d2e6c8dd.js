import{r as _,a as i,o as g,c as D,b as e,w as o,d as b,k as f,H as G,m as J,z as K,A as O,B as P,l as Q,g as X,f as I,x as V}from"./index-fd002604.js";import Y from"./WarningParameters-b2b520df.js";import"./ColorItem-d7e9f1af.js";const Z={class:"collection-answer-wrapper"},ee={key:0},le={class:"dialog-footer"},ae={__name:"AnswerCollections",props:["answerCollectionsData","answersList"],emits:["addCollectionToList","deleteCollection","updateCollectionItem"],setup(h,{emit:k}){const u=h,R=_(),s=_(null),d=_(!1),t=_(),v=_(!1),r=_([]),U=()=>{const n=[];for(let l=0;l<r.value.length;l++)r.value[l]&&n.push(u.answersList[l].id);t.value.selectedIdList=n,console.log(t.value),k("addCollectionToList",t.value),d.value=!1},y=()=>{if(u.answerCollectionsData.length===0)return 0;const n=u.answerCollectionsData.map(m=>m.id);return Math.max(...n)},x=()=>{if(u.answerCollectionsData.length===0)return 0;const n=u.answerCollectionsData.map(m=>m.seqNo);return Math.max(...n)},T=()=>{r.value=u.answersList.map(n=>!1),t.value={id:y()+1,name:"",description:"",seqNo:x()+1,checkedList:[],isRight:!1,useCollectionWarning:!1,collectionWarning:{text:"Все верно",color:"#A3D65C",image:{label:"",imageURL:""},showTime:0,buttons:[{buttonName:"Закрыть",action:{name:"closeModalWarning"}}]}},v.value=!1,d.value=!0},A=()=>{s.value&&(console.log(s.value),r.value=u.answersList.map(n=>!!s.value.selectedIdList.find(l=>l===n.id)),console.log(r.value),t.value={id:y()+1,name:s.value.name+"copy",description:s.value.description,seqNo:x()+1,checkedList:s.value.checkedList,isRight:s.value.isRight,useCollectionWarning:s.value.useCollectionWarning,collectionWarning:s.value.collectionWarning},v.value=!1,d.value=!0)},B=(n,l)=>{r.value=u.answersList.map(m=>!!n.selectedIdList.find(C=>C===m.id)),t.value=n,v.value=!0,d.value=!0},M=()=>{k("updateCollectionItem",t.value),d.value=!1},$=()=>{s.value&&k("deleteCollection",s.value.id)},E=n=>{s.value=n};return(n,l)=>{const m=i("el-col"),C=i("el-row"),c=i("el-button"),z=i("el-popconfirm"),p=i("el-table-column"),F=i("el-icon"),L=i("el-table"),N=i("el-input"),w=i("el-form-item"),S=i("el-checkbox"),W=i("el-switch"),H=i("el-form"),j=i("el-dialog");return g(),D("div",Z,[e(C,null,{default:o(()=>[e(m,null,{default:o(()=>[b("Коллекции ответов пользователя")]),_:1})]),_:1}),e(C,null,{default:o(()=>[e(m,null,{default:o(()=>[e(c,{type:"success",icon:f(G),onClick:T},null,8,["icon"]),e(c,{type:"success",icon:f(J),onClick:A},null,8,["icon"]),e(c,{type:"warning",icon:f(K),onClick:n.moveModuleTestUp},null,8,["icon","onClick"]),e(c,{type:"warning",icon:f(O),onClick:n.moveModuleTestDown},null,8,["icon","onClick"]),e(z,{"confirm-button-text":"Да","cancel-button-text":"Нет","icon-color":"#F56C6C",title:"Вы уверены, что хотите удалить коллекцию?",onConfirm:$,width:"350"},{reference:o(()=>[e(c,{type:"danger",icon:f(P)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e(L,{ref_key:"tableAnswerCollectionsRef",ref:R,data:h.answerCollectionsData,onCurrentChange:E,style:{width:"100%"},border:"","highlight-current-row":""},{default:o(()=>[e(p,{prop:"id",label:"id",width:"60"}),e(p,{prop:"seqNo",label:"seqNo",width:"100"}),e(p,{prop:"name",label:"Наименование",width:"180"}),e(p,{prop:"collection",label:"Коллекция",width:"180"}),e(p,{label:"Управление"},{default:o(a=>[e(c,{class:"control_btn",size:"small",onClick:q=>B(a.row)},{default:o(()=>[e(F,{size:"small",color:"#FF8A00"},{default:o(()=>[e(f(Q))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(j,{modelValue:d.value,"onUpdate:modelValue":l[5]||(l[5]=a=>d.value=a),title:"Набор ответов",width:"700"},{footer:o(()=>[X("div",le,[e(c,{onClick:l[4]||(l[4]=a=>d.value=!1)},{default:o(()=>[b("Отмена")]),_:1}),v.value?V("",!0):(g(),I(c,{key:0,type:"primary",onClick:U},{default:o(()=>[b("Создать")]),_:1})),v.value?(g(),I(c,{key:1,type:"primary",onClick:M},{default:o(()=>[b("Сохранить")]),_:1})):V("",!0)])]),default:o(()=>[e(H,{model:t.value},{default:o(()=>[e(w,{label:"Наименование"},{default:o(()=>[e(N,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.name=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Описание"},{default:o(()=>[e(N,{modelValue:t.value.description,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.description=a)},null,8,["modelValue"])]),_:1}),e(L,{ref:"multipleTableRef",data:h.answersList,style:{width:"100%"},border:""},{default:o(()=>[e(p,{property:"answerText",label:"Ответ",width:"200"}),e(p,{label:"Выбран",width:"100"},{default:o(a=>[e(S,{modelValue:r.value[a.$index],"onUpdate:modelValue":q=>r.value[a.$index]=q},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{label:"Необязательный",width:"100"})]),_:1},8,["data"]),e(w,{label:"Верный ответ"},{default:o(()=>[e(W,{modelValue:t.value.isRight,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.isRight=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Предупреждение"},{default:o(()=>[e(W,{modelValue:t.value.useCollectionWarning,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.useCollectionWarning=a)},null,8,["modelValue"])]),_:1}),t.value.useCollectionWarning?(g(),D("div",ee,[e(Y,{parameters:t.value.collectionWarning},null,8,["parameters"])])):V("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{ae as default};
