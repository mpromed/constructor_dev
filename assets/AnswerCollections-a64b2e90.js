import{r as f,a as s,o as g,c as D,b as e,w as o,d as b,k as _,H as K,m as O,z as P,A as Q,B as X,l as Y,g as Z,f as q,x as k}from"./index-85e3ceff.js";import ee from"./WarningParameters-6f7c817a.js";import"./ColorItem-96862df8.js";const le={class:"collection-answer-wrapper"},oe={key:0},te={class:"dialog-footer"},se={__name:"AnswerCollections",props:["answerCollectionsData","answersList"],emits:["addCollectionToList","deleteCollection","updateCollectionItem"],setup(h,{emit:V}){const c=h,R=f(),i=f(null),r=f(!1),t=f(),v=f(!1),u=f([]),U=()=>{const n=[];for(let l=0;l<u.value.length;l++)u.value[l]&&n.push(c.answersList[l].id);t.value.selectedIdList=n,console.log(t.value),V("addCollectionToList",t.value),r.value=!1},x=()=>{if(c.answerCollectionsData.length===0)return 0;const n=c.answerCollectionsData.map(m=>m.id);return Math.max(...n)},y=()=>{if(c.answerCollectionsData.length===0)return 0;const n=c.answerCollectionsData.map(m=>m.seqNo);return Math.max(...n)},A=()=>{u.value=c.answersList.map(n=>!1),t.value={id:x()+1,name:"",description:"",seqNo:y()+1,checkedList:[],isRight:!1,useCollectionWarning:!1,collectionWarning:{text:"Все верно",color:"#A3D65C",image:{label:"",imageURL:""},showTime:0,buttons:[{buttonName:"Закрыть",action:{name:"closeModalWarning"}}]}},v.value=!1,r.value=!0},T=()=>{i.value&&(console.log(i.value),u.value=c.answersList.map(n=>!!i.value.selectedIdList.find(l=>l===n.id)),console.log(u.value),t.value={id:x()+1,name:i.value.name+"copy",description:i.value.description,seqNo:y()+1,checkedList:i.value.checkedList,isRight:i.value.isRight,useCollectionWarning:i.value.useCollectionWarning,collectionWarning:i.value.collectionWarning},v.value=!1,r.value=!0)},B=(n,l)=>{u.value=c.answersList.map(m=>!!n.selectedIdList.find(C=>C===m.id)),t.value=n,v.value=!0,r.value=!0},$=()=>{const n=[];for(let l=0;l<u.value.length;l++)u.value[l]&&n.push(c.answersList[l].id);t.value.selectedIdList=n,V("updateCollectionItem",t.value),r.value=!1},E=()=>{i.value&&V("deleteCollection",i.value.id)},z=n=>{i.value=n},F=()=>{if(!i.value){console.log("выберите строку");return}console.log(c.answerCollectionsData)},M=()=>{if(!i.value){console.log("выберите строку");return}};return(n,l)=>{const m=s("el-col"),C=s("el-row"),d=s("el-button"),S=s("el-popconfirm"),p=s("el-table-column"),H=s("el-icon"),L=s("el-table"),N=s("el-input"),w=s("el-form-item"),j=s("el-checkbox"),I=s("el-switch"),G=s("el-form"),J=s("el-dialog");return g(),D("div",le,[e(C,null,{default:o(()=>[e(m,null,{default:o(()=>[b("Коллекции ответов пользователя")]),_:1})]),_:1}),e(C,null,{default:o(()=>[e(m,null,{default:o(()=>[e(d,{type:"success",icon:_(K),onClick:A},null,8,["icon"]),e(d,{type:"success",icon:_(O),onClick:T},null,8,["icon"]),e(d,{type:"warning",icon:_(P),onClick:F},null,8,["icon"]),e(d,{type:"warning",icon:_(Q),onClick:M},null,8,["icon"]),e(S,{"confirm-button-text":"Да","cancel-button-text":"Нет","icon-color":"#F56C6C",title:"Вы уверены, что хотите удалить коллекцию?",onConfirm:E,width:"350"},{reference:o(()=>[e(d,{type:"danger",icon:_(X)},null,8,["icon"])]),_:1})]),_:1})]),_:1}),e(L,{ref_key:"tableAnswerCollectionsRef",ref:R,data:h.answerCollectionsData,onCurrentChange:z,style:{width:"100%"},border:"","highlight-current-row":""},{default:o(()=>[e(p,{prop:"id",label:"id",width:"60"}),e(p,{prop:"seqNo",label:"seqNo",width:"100"}),e(p,{prop:"name",label:"Наименование",width:"180"}),e(p,{prop:"collection",label:"Коллекция",width:"180"}),e(p,{label:"Управление"},{default:o(a=>[e(d,{class:"control_btn",size:"small",onClick:W=>B(a.row)},{default:o(()=>[e(H,{size:"small",color:"#FF8A00"},{default:o(()=>[e(_(Y))]),_:1})]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"]),e(J,{modelValue:r.value,"onUpdate:modelValue":l[5]||(l[5]=a=>r.value=a),title:"Набор ответов",width:"700"},{footer:o(()=>[Z("div",te,[e(d,{onClick:l[4]||(l[4]=a=>r.value=!1)},{default:o(()=>[b("Отмена")]),_:1}),v.value?k("",!0):(g(),q(d,{key:0,type:"primary",onClick:U},{default:o(()=>[b("Создать")]),_:1})),v.value?(g(),q(d,{key:1,type:"primary",onClick:$},{default:o(()=>[b("Сохранить")]),_:1})):k("",!0)])]),default:o(()=>[e(G,{model:t.value},{default:o(()=>[e(w,{label:"Наименование"},{default:o(()=>[e(N,{modelValue:t.value.name,"onUpdate:modelValue":l[0]||(l[0]=a=>t.value.name=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Описание"},{default:o(()=>[e(N,{modelValue:t.value.description,"onUpdate:modelValue":l[1]||(l[1]=a=>t.value.description=a)},null,8,["modelValue"])]),_:1}),e(L,{ref:"multipleTableRef",data:h.answersList,style:{width:"100%"},border:""},{default:o(()=>[e(p,{property:"answerText",label:"Ответ",width:"200"}),e(p,{label:"Выбран",width:"100"},{default:o(a=>[e(j,{modelValue:u.value[a.$index],"onUpdate:modelValue":W=>u.value[a.$index]=W},null,8,["modelValue","onUpdate:modelValue"])]),_:1}),e(p,{label:"Необязательный",width:"100"})]),_:1},8,["data"]),e(w,{label:"Верный ответ"},{default:o(()=>[e(I,{modelValue:t.value.isRight,"onUpdate:modelValue":l[2]||(l[2]=a=>t.value.isRight=a)},null,8,["modelValue"])]),_:1}),e(w,{label:"Предупреждение"},{default:o(()=>[e(I,{modelValue:t.value.useCollectionWarning,"onUpdate:modelValue":l[3]||(l[3]=a=>t.value.useCollectionWarning=a)},null,8,["modelValue"])]),_:1}),t.value.useCollectionWarning?(g(),D("div",oe,[e(ee,{parameters:t.value.collectionWarning},null,8,["parameters"])])):k("",!0)]),_:1},8,["model"])]),_:1},8,["modelValue"])])}}};export{se as default};
