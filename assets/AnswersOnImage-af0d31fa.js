import{_ as Y,r as y,q as j,G as z,a as r,o as i,c as d,b as a,w as _,f as V,v as x,g as l,F as S,e as R,H as $,I as G,x as A,d as M,J,K}from"./index-755878c9.js";import Q from"./ContentImages-af64491d.js";import W from"./ColorItem-1acd2e25.js";import Z from"./ActionItem-fa42caed.js";import ee from"./AnswerCollections-1eaa8c2f.js";import"./WarningParameters-0bfc9b10.js";const L=c=>(J("data-v-b938ac39"),c=c(),K(),c),te={key:0},ne=["src"],oe=["onMousedown"],se={class:"marker-index"},ae={key:1,class:"markers-table"},le={key:2,class:"marker-info"},ie={class:"slider-text"},ce={class:"checkboxes"},me=L(()=>l("div",{class:"checkbox-text"},"Правильный ?",-1)),re={class:"checkboxes"},de=L(()=>l("div",{class:"checkbox-text"},"Не обязательный ?",-1)),ue=L(()=>l("div",{class:"slider-text"},"Размер маркера ",-1)),pe=L(()=>l("div",{class:"slider-text"},"Размер хитбокса ",-1)),we={class:"action_edit"},O=2,ge=50,T=2,he=50,ve={__name:"AnswersOnImage",props:["componentData"],setup(c){const t=c,s=y(null),U=y(null),p=y(null),w=y({width:0,height:0});t.componentData.answersButtonType="buttonsOnImage";const C=(n,e)=>n/e*100,f=(n,e)=>n/100*e,B=n=>({position:"absolute",top:`${n.y}%`,left:`${n.x}%`,transform:"translate(-50%, -50%)",width:`${f(n.size,w.value.width)}px`,height:`${f(n.size,w.value.width)}px`,background:`${n.color}`}),E=n=>({position:"absolute",top:`${n.y}%`,left:`${n.x}%`,transform:"translate(-50%, -50%)",width:`${f(n.hitboxSize,w.value.width)}px`,height:`${f(n.hitboxSize,w.value.width)}px`,backgroundColor:`${n.color}55`,borderRadius:"50%",display:"flex",justifyContent:"center",alignItems:"center",boxSizing:"border-box",cursor:"pointer"}),q=()=>{s.value!==null&&(t.componentData.answersList.splice(s.value,1),s.value=t.componentData.answersList.length-1)},H=n=>{if(n.target.classList.contains("content-image")){const e=p.value.getBoundingClientRect(),u=(n.clientX-e.left)/e.width*100,m=(n.clientY-e.top)/e.height*100;t.componentData.answersList.push({index:t.componentData.answersList.length+1,isRight:!1,notRequired:!1,answerText:"",action:{doAction:!1,clickAction:!1,name:"moveToStep",internalId:0,checkQuestion:!1,trackRepeatAnswer:!1},style:{x:u,y:m,size:C(O,e.width),hitboxSize:C(T,e.width)}}),s.value=t.componentData.answersList.length-1}},N=(n,e)=>{n.preventDefault(),s.value=e;const u=g=>{const h=p.value.getBoundingClientRect();let D=(g.clientX-h.left)/h.width*100,v=(g.clientY-h.top)/h.height*100;D=Math.max(0,Math.min(D,100)),v=Math.max(0,Math.min(v,100)),t.componentData.answersList[s.value].style.x=D,t.componentData.answersList[s.value].style.y=v},m=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",u),document.addEventListener("mouseup",m)},k=()=>{z(()=>{if(p.value&&p.value.complete){const{width:n,height:e}=p.value.getBoundingClientRect();w.value.width=n,w.value.height=e}else console.log("Изображение еще не загружено или элемент не найден")})};j(async()=>{await z(),k()});const F=n=>{let e=n.index-1;s.value=e};return(n,e)=>{const u=r("el-switch"),m=r("el-form-item"),g=r("el-table-column"),h=r("el-table"),D=r("el-input"),v=r("el-checkbox"),I=r("el-slider"),P=r("el-button");return i(),d(S,null,[a(m,{label:"Ответы на картинке?"},{default:_(()=>[a(u,{modelValue:t.componentData.isAnswersOnImage,"onUpdate:modelValue":e[0]||(e[0]=o=>t.componentData.isAnswersOnImage=o),style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"}},null,8,["modelValue"])]),_:1}),t.componentData.isAnswersOnImage?(i(),d("div",te,[a(m,{label:"Множественный выбор:"},{default:_(()=>[a(u,{modelValue:t.componentData.multiple,"onUpdate:modelValue":e[1]||(e[1]=o=>t.componentData.multiple=o)},null,8,["modelValue"])]),_:1}),t.componentData.isAnswersOnImage?(i(),V(m,{key:0,label:"Картинка:"},{default:_(()=>[t.componentData.imagesData&&t.componentData.isAnswersOnImage?(i(),V(Q,{key:0,componentData:t.componentData.imagesData,isSingleImage:t.componentData.isAnswersOnImage},null,8,["componentData","isSingleImage"])):x("",!0),l("div",{class:"image-container",onClick:e[2]||(e[2]=o=>H(o)),ref_key:"imageContainer",ref:U,onLoad:k},[l("img",{class:"content-image",src:t.componentData.imagesData.imagesList[0].imageURL,ref_key:"imageElement",ref:p,onLoad:k},null,40,ne),(i(!0),d(S,null,R(t.componentData.answersList,(o,b)=>(i(),d("div",{class:"marker",key:b,style:$(B(o.style)),onMousedown:G(X=>N(X,b),["prevent"])},[l("div",se,A(o.index),1)],44,oe))),128)),(i(!0),d(S,null,R(t.componentData.answersList,(o,b)=>(i(),d("div",{class:"hitbox",key:b,style:$(E(o.style))},null,4))),128))],544),t.componentData.answersList.length>0?(i(),d("div",ae,[a(h,{data:t.componentData.answersList,style:{width:"100%"},border:"","highlight-current-row":"",onRowClick:F},{default:_(()=>[a(g,{prop:"index",label:"id",width:"40"}),a(g,{prop:"answerText",label:"Текст ответа",width:"115"}),a(g,{prop:"isRight",label:"Значение",width:"115"},{default:_(({row:o})=>[l("span",null,A(o.isRight?"Правильный":"Неправильный"),1)]),_:1})]),_:1},8,["data"])])):x("",!0),s.value!==null&&t.componentData.answersList.length>0?(i(),d("div",le,[l("div",ie,[M("Текст ответа"),a(D,{modelValue:t.componentData.answersList[s.value].answerText,"onUpdate:modelValue":e[3]||(e[3]=o=>t.componentData.answersList[s.value].answerText=o)},null,8,["modelValue"])]),l("div",ce,[me,a(v,{modelValue:t.componentData.answersList[s.value].isRight,"onUpdate:modelValue":e[4]||(e[4]=o=>t.componentData.answersList[s.value].isRight=o),size:"large"},null,8,["modelValue"])]),l("div",re,[de,a(v,{modelValue:t.componentData.answersList[s.value].notRequired,"onUpdate:modelValue":e[5]||(e[5]=o=>t.componentData.answersList[s.value].notRequired=o),size:"large"},null,8,["modelValue"])]),ue,a(I,{modelValue:t.componentData.answersList[s.value].style.size,"onUpdate:modelValue":e[6]||(e[6]=o=>t.componentData.answersList[s.value].style.size=o),min:O,max:ge,step:.1},null,8,["modelValue"]),pe,a(I,{modelValue:t.componentData.answersList[s.value].style.hitboxSize,"onUpdate:modelValue":e[7]||(e[7]=o=>t.componentData.answersList[s.value].style.hitboxSize=o),min:T,max:he,step:.1},null,8,["modelValue"]),a(P,{onClick:q},{default:_(()=>[M("Удалить маркер")]),_:1}),a(W,{modelValue:t.componentData.answersList[s.value].style.color,"onUpdate:modelValue":e[8]||(e[8]=o=>t.componentData.answersList[s.value].style.color=o)},null,8,["modelValue"]),l("div",we,[a(Z,{action:t.componentData.answersList[s.value].action},null,8,["action"])])])):x("",!0),c.componentData.answersList?(i(),V(ee,{key:3,answerCollectionsData:c.componentData.answerCollections,answersList:c.componentData.answersList,onAddCollectionToList:e[9]||(e[9]=o=>n.addCollectionToList(o)),onDeleteCollection:e[10]||(e[10]=o=>n.deleteCollection(o))},null,8,["answerCollectionsData","answersList"])):x("",!0)]),_:1})):x("",!0)])):x("",!0)],64)}}},Le=Y(ve,[["__scopeId","data-v-b938ac39"]]);export{Le as default};
